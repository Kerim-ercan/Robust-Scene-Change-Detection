{
    "model": {
        "checkpoints": "/home/divit/projects/models/dinov2.2CrossAttn.Diff-CMU.pth",
        "target-shp-row": 504,
        "target-shp-col": 504
    },
    "optimizer": {
        "epochs": 20,
        "warmup-epoch": 2,
        "learn-rate": 2e-05,
        "loss-weight": true,
        "lr-scheduler": "cosine",
        "grad-scaler": true
    },
    "dataset": {
        "batch-size": 4,
        "num-workers": 4,
        "dataset": "CUSTOM",
        "hflip-prob": 0.5,
        "figsize": 224
    },
    "evaluation": {
        "trainset": 5
    },
    "wandb": {
        "project": "custom-change-detection",
        "name": "custom-dataset-finetune",
        "output-path": "/home/divit/projects/Robust-Scene/Robust-Scene-Change-Detection/output/2025-08-21.09-51-24",
        "save-checkpoint-freq": 5
    },
    "environment": {
        "dry": false,
        "seed": 123,
        "verbose": true,
        "device": "cuda"
    }
}

     use the checkpoints from pretrained model:

{
    "model": {
        "name": "dino2 + cross_attention",
        "dino-model": "dinov2_vits14",
        "layer1": 11,
        "facet1": "query",
        "facet2": "query",
        "num-heads": 1,
        "dropout-rate": 0.1,
        "target-shp-row": 504,
        "target-shp-col": 504,
        "num-blocks": 1,
        "freeze-dino": true,
        "unfreeze-dino-last-n-layer": 0
    },
    "optimizer": {
        "epochs": 100,
        "warmup-epoch": 10,
        "learn-rate": 0.0001,
        "loss-weight": true,
        "lr-scheduler": "cosine",
        "grad-scaler": true
    },
    "dataset": {
        "batch-size": 4,
        "num-workers": 4,
        "dataset": "VL_CMU_CD",
        "hflip-prob": 0.5,
        "diff-augment": true,
        "figsize": null
    },
    "evaluation": {
        "trainset": 0
    },
    "wandb": {
        "project": "dino-change-detection",
        "name": "hpc-cross-attention-aug-diff-2",
        "output-path": "/hpcfs/users/a1904931/Projects/img-cd/output/hpc-cross-attention-aug-diff-2",
        "save-checkpoint-freq": 0
    },
    "environment": {
        "dry": false,
        "seed": 123,
        "verbose": true,
        "device": "cuda"
    }
}
Using cache found in /home/divit/.cache/torch/hub/facebookresearch_dinov2_main
A matching Triton is not available, some optimizations will not be enabled.
Error caught was: No module named 'triton'
<All keys matched successfully>
Loaded 130 samples for train mode
Loaded 20 samples for test mode
     ===== running 0 epoch =====
     2025-08-21.09-51-30

     *** train one epoch ***
     input_1:  torch.Size([4, 3, 224, 224])
     input_2:  torch.Size([4, 3, 224, 224])
     targets:  torch.Size([4, 224, 224])
     output:  torch.Size([4, 504, 504, 2]) -> torch.Size([4, 2, 504, 504])
Traceback (most recent call last):
  File "/home/divit/projects/Robust-Scene/Robust-Scene-Change-Detection/scripts/fine_tune.py", line 453, in <module>
    main(args)
  File "/home/divit/projects/Robust-Scene/Robust-Scene-Change-Detection/scripts/fine_tune.py", line 261, in main
    loss, data_inds, batch_losses, train_time = train_one_epoch(
  File "/home/divit/projects/Robust-Scene/Robust-Scene-Change-Detection/scripts/fine_tune.py", line 91, in train_one_epoch
    loss = criterion(transform_outputs, targets)
  File "/home/divit/projects/Robust-Scene/.venv310/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/divit/projects/Robust-Scene/.venv310/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1174, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/divit/projects/Robust-Scene/.venv310/lib/python3.10/site-packages/torch/nn/functional.py", line 3026, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: input and target batch or spatial sizes don't match: target [4, 224, 224], input [4, 2, 504, 504]
